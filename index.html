<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


</head>

<body>



    <div class="mainBlock">
    </div>
    <div class="fullScreen">
        <div class="sandwichbox">
            <div class="meat"></div>
            <div class="meat"></div>
            <div class="meat"></div>
        </div>
        <div class="Header">
            <!-- <img src="https://i.imgur.com/queCelg.png" id="headerimage" /> -->
            <!-- <img src="https://i.imgur.com/nAUSSi7.png" id="headerimage2" /> -->
            <div class="leftSide">
            </div>
            <div class="rightSide"></div>
        </div>
        <div class="infoBox">
            <div class="readerBox"></div>
            <div class="readerBox"></div>
            <div class="readerBox"></div>
            <div class="readerBox"></div>
            <div class="readerBox"></div>
            <div class="readerBox"></div>
        </div>
        <div class="infoBox2">
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
            <div class="readerBox2"></div>
        </div>
        <div class="playButtondiv"><button id="playButton">Up</button></div>
        <div class="playButtondiv"><button id="playButton3">Down</button></div>
        <div class="playButtondiv"><button id="switch">Switch</button></div>
        <div class="playButtondiv"><button id="scroll">Scroll</button></div>
    </div>




    <div id="set-height"></div>

    <video id="v0" class="backgroundVideo" tabindex="0" , autobuffer preload>
        <source type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' src="./background3.webm">
        </source>
    </video>

    <video id="v1" class="backgroundVideo" tabindex="0" , autobuffer preload>
        <source type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' src="./backgroundreverse0001-0505.webm">
        </source>
    </video>
    <script>

        const playIndex = {
            up: {
                firstImage: 0,
                secondImage: 4.1,
                thirdImage: 8.2,
                forthImage: 12.3,
                fifthImage: 16.4,
                sixthImage: 20.5,
            },
            down: {
                firstImage: 21,
                secondImage: 17,
                thirdImage: 13,
                forthImage: 9,
                fifthImage: 4.9,
                sixthImage: 0,
            }
        }
        const locators = ["firstImage", "secondImage", "thirdImage", "forthImage", "fifthImage", "sixthImage"];

        let endTime;
        let currentLocation = 0;
        let newLocation = 0;
        let currentHeight = 0;

        $('#v0')[0].currentTime = playIndex.up[locators[currentLocation]];
        $('#v1')[0].currentTime = playIndex.down[locators[currentLocation]];
        // let onTop = true;
        $("#switch").click(() => {
            if (onTop === true) {
                // ("#swich").css("background-color", "blue");
                $("#v1").css("z-index", 5)
                onTop = false;
            } else {
                // ("#swich").css("background-color", "red");
                $("#v1").css("z-index", 20)
                onTop = true;
            }
        });
        $('#playButton').click(function (e) {

            if (currentLocation === 5) {
                return null;
            } else {
                newLocation++;
                onChange(true)
            };

        });


        $('#playButton3').click(function (e) {

            if (currentLocation === 0) {
                return null;
            } else {
                newLocation--;
                onChange(false);
            };


        });


        function onChange(direction) {
            (direction ? up(newLocation) : down(newLocation));
        }

        $("#scroll").click(() => {
            scroll("2000px", 4000);
        })
        var scrollCount = 0,
            latestScrollTop = 0,
            doc = $(".infoBox2"),
            top = 0;
        let locationVar = 0
        // Bind window scroll event
        doc.scroll(function () {
            let value = doc.scrollTop();
            //from 0 to 550 leave at bottom 
            if (value >= 0 && value < 600) {
                let oldlocation = locationVar;
                locationVar = 0;
                checkForChange(oldlocation, locationVar);
            }
            //550 to 1101
            if (value > 600 && value < 1200) {
                let oldlocation = locationVar;
                locationVar = 1;
                checkForChange(oldlocation, locationVar);
            }
            //1101 to 1651
            if (value > 1200 && value < 1800) {
                let oldlocation = locationVar;
                locationVar = 2;
                checkForChange(oldlocation, locationVar);
            }
            //1651 to 2021
            if (value > 1800 && value < 2400) {
                let oldlocation = locationVar;
                locationVar = 3;
                checkForChange(oldlocation, locationVar);
            }
            //2021 to 2751
            if (value > 2400 && value < 3000) {
                let oldlocation = locationVar;
                locationVar = 4;
                checkForChange(oldlocation, locationVar);
            }
            //2751 to 3303
            if (value > 3000 && value <= 3600) {
                let oldlocation = locationVar;
                locationVar = 5;
                checkForChange(oldlocation, locationVar);
            }

            // console.log()
            /* else */
            /*do this*/
        });
        function checkForChange(oldloc, newloc) {
            if (oldloc === newloc) {

            } else {
                if (oldloc > newloc) {
                    down(newloc);

                } else {
                    up(newloc);

                }
                console.log("old location: " + oldloc + " New location: " + newloc);
            }


        }


        function scroll(heightFromTop, seconds, upOrDown) {
            if (upOrDown === true) {
                let box = $(".infoBox");
                let height = (currentHeight + box.height()) + "px";
                currentHeight = (currentHeight + box.height());
                console.log(height);
                box.animate({ scrollTop: height }, seconds);

            } else {
                let box = $(".infoBox");
                let height = (currentHeight - box.height()) + "px";
                currentHeight = (currentHeight - box.height());
                console.log(height);
                box.animate({ scrollTop: height }, seconds);

            }
        }

        // new ResizeSensor(jQuery('.infoBox'), function () {
        //     console.log('main content dimension changed');
        // });
        function down(newLocation) {
            scroll("2000px", 3500, false);
            console.log("down function activated");
            console.log("newLocation: " + newLocation)
            //required video is brought to the top 
            $("#v1").css("z-index", 20);
            //endtime is updated 
            endTime = playIndex.down[locators[newLocation]];
            console.log("endTime: " + endTime);
            //required video is played
            $('#v1')[0].play();
            //lower video is given new location
            $('#v0')[0].currentTime = playIndex.up[locators[newLocation]];
            //After video is played:
            //currentLocation is updated
            checkTime2();
        }
        function up(newLocation) {

            scroll("2000px", 3500, true);
            console.log("up function activated");
            console.log("newLocation: " + newLocation)
            //required video is brought to the top 
            $("#v1").css("z-index", 5);
            //endtime is updated 
            endTime = playIndex.up[locators[newLocation]];
            console.log("endTime: " + endTime);
            //required video is played
            $('#v0')[0].play();
            //lower video is given new location
            $('#v1')[0].currentTime = playIndex.down[locators[newLocation]];
            //After video is played:
            //currentLocation is updated
            checkTime();

        }
        function checkTime2() {
            if ($('#v1')[0].currentTime >= endTime) {
                //Video is Paused
                $('#v1')[0].pause();
                //After video is played:
                //currentLocation is updated
                currentLocation = newLocation;
            } else {
                /* call checkTime every 1/10th 
                   second until endTime */
                setTimeout(checkTime2, 100);
            }
        }
        function checkTime() {
            if ($('#v0')[0].currentTime >= endTime) {
                //Video is Paused
                $('#v0')[0].pause();
                //After video is played:
                //currentLocation is updated
                currentLocation = newLocation;
            } else {
                /* call checkTime every 1/10th 
                   second until endTime */
                setTimeout(checkTime, 100);
            }
        }


    </script>
</body>

</html>